
{% extends "main/layout.html" %}
{% block content %}
<h3 class="mb-3">Results â€“ {{ data.product_name }}</h3>
<div class="row g-3">
  <div class="col-lg-6">
    <div class="card bg-body-tertiary border-0 shadow-sm"><div class="card-body">
      <h5>Insights</h5>
      <p class="mb-1"><b>Reviews analyzed:</b> {{ data.reviews_count }}</p>
      <p class="mb-1"><b>Sentiment avg:</b> {{ data.analysis.sentiment.avg }}</p>
      <p class="mb-3"><b>Distribution:</b> {{ data.analysis.sentiment.distribution }}</p>
      <h6 class="text-secondary">Top phrases</h6>
      <ul class="small">{% for p in data.analysis.phrases %}<li>{{ p }}</li>{% endfor %}</ul>
      <h6 class="text-secondary">Themes (sample reviews)</h6>
      {% for k, arr in data.analysis.themes.items() %}
        <p class="mb-1"><b>{{ k }}</b></p>
        <ul class="small">{% for x in arr %}<li>{{ x }}</li>{% endfor %}</ul>
      {% endfor %}
    </div></div>
  </div>
  <div class="col-lg-6">
    <div class="card bg-body-tertiary border-0 shadow-sm"><div class="card-body">
      <h5>Generated Script</h5>
      {% if data.generated %}
        <pre class="rounded p-3 bg-dark-subtle text-light small" id="copyBlock">{{ data.generated }}</pre>
        <button class="btn btn-primary btn-sm" onclick="copyBlock()">Copy</button>
      {% else %}
        <div class="alert alert-info">AI generation is disabled (no OpenAI key). Use the prompt below with any LLM.</div>
      {% endif %}
      <h6 class="mt-3">Prompt</h6>
      <textarea class="form-control" rows="8">{{ data.prompt }}</textarea>
      <a class="btn btn-outline-light btn-sm mt-3" href="{{ url_for('download', fname=file) }}">Download JSON</a>
      <a class="btn btn-outline-secondary btn-sm mt-3" href="{{ url_for('dashboard') }}">Generate again</a>
    </div></div>
  </div>
</div>
{% endblock %}
